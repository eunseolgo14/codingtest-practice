# 광고 삽입

**작성일**: 2025-10-16</br>
**목표**: 누적합(Prefix Sum) + 슬라이딩 윈도우를 이용한 구간 최대 누적 시청 시간 구하기

---

## 최초 제출(MySubmit.java) 시 틀린 부분
1. **퇴장 시점 연산 오류**
   - `totalView[sec[1]] += 1;`로 처리하여 시청자가 빠져나가는 시점을 더해버림.
   - 시청자 수가 실제보다 계속 증가해 모든 누적합 결과가 왜곡됨.
   - 퇴장은 -=로 변경하여 시청자 감소 반영해야해서 `(totalView[sec[1]] -= 1;)`로 수정되어야 함.

2. **슬라이딩 윈도우 초기 구간 누락**
   - `maxView = 0`으로 초기화하여 0초부터 광고를 넣는 첫 구간이 계산되지 않음 (실제 정답이 0초 근처에 있을 때 오답 발생).
   - 초기값을 `maxView = totalView[totalAd - 1]`로 설정해 `0 ~ advTime` 구간 값을 대입해야 함.

3. **반복문 경계 조건 모호**
    - `for (int i = totalAd; i < totalView.length; i++)` → `totalView.length = totalVideo + 1` 이므로 영상의 마지막 초가 누락될 수 있음.
    - `for (int i = totalAd; i <= totalVideo; i++)`로 해야 영상 끝까지 탐색.

4. **누적합 개념 이해 부족**
    - 누적합을 두 번 하는 이유를 이해하지 못해 디버깅이 어려움.
        - 1차 누적합 → 시간별 시청자 수
        - 2차 누적합 → 시간의 흐름에 따른 총 누적 시청시간
        - 슬라이딩 윈도우 → 광고 구간별 순수 시청시간 비교


---

## 2차 제출(MySolution.java) 시 수정한 부분
- 퇴장 처리: `totalView[sec[1]] -= 1;`
- 초기 구간 포함: `long maxView = totalView[totalAd - 1];`
- 탐색 범위 조정: `i <= totalVideo`

---
## 헷갈렸던 것/ 새로 배운 것
<p align="center">
   <img src="./assets/advertisement_insertion_1.png" alt="Route Optimization" width="100%"/>
</p>

- 누적합을 2번 수행하는 이유:
    1. 첫 번째는 ‘시각별 시청자 수’,
    2. 두 번째는 ‘시간의 흐름에 따른 누적 시청시간’ 계산을 위함.
- 슬라이딩 윈도우에서 `total[i] - total[i - advTime]`은 광고 구간 `(i - advTime + 1) ~ i`의 순수 누적 시청시간을 의미.
- `i - advTime + 1`의 +1은 시작점을 포함시키는 범위 보정임.

---

## 기억할 포인트
- 입장 +1 / 퇴장 -1은 모든 누적합 문제의 기본 패턴이라고 함.
- 1차 누적합: 시점별 변화량 → 현재 상태값
- 2차 누적합: 상태값의 누적 → 총합
- 슬라이딩 윈도우: `(total[i] - total[i - window])`로 구간합 계산
- 광고 삽입 문제의 핵심: “변화량 → 상태값 → 누적합 → 구간합”의 4단계 사고 구조

